sap.ui.define(["sap/ui/core/mvc/Controller","custom/FilerobotImageEditor","sap/ui/Device","sap/ui/model/json/JSONModel","sap/m/Image","sap/ui/core/Icon","custom/JSZip","sap/m/MessageToast"],(e,t,i,o,a,s,n,l)=>{"use strict";let r=0;let d={};let g;let m;return e.extend("ui5.imgeditor.controller.App",{onInit(){let e=1;if(i.system.desktop){e=4}else if(i.system.tablet){e=2}let t=new o({pagesCount:e});this.getView().setModel(t,"settings");let a=new o(d);this.getView().setModel(a,"imgEditors");this._setNumberOfImagesInCarousel(1)},onBeforeRendering(){},onAfterRendering(){},_getFileSizeInBase64:function(e){const t=e.endsWith("==")?2:e.endsWith("=")?1:0;const i=e.length/4*3-t;const o=i/1024;const a=o/1e3;return{sizeInBytes:i,sizeInKB:o,sizeInMB:a}},onUploadnShow:function(e){var t=this.getView().byId("myFileUploader");var i=t.oFileUpload.files[0];var o=new FileReader;o.onload=function(e){var t=e.target.result;var i=new sap.m.Image({src:t});var o=this.getView().byId("myPanel");o.addContent(i)}.bind(this);o.readAsDataURL(i)},onUploadAddImage:function(){let e=this.getView().byId("fileUploaderCarousel");let t=e.oFileUpload.files[0];if(t){let e=new FileReader;e.onload=function(e){let t=e.target.result;this._addImageToCarousel(t)}.bind(this);e.readAsDataURL(t)}},onOpenImgEditor:function(e,i){if(g&&m!==i){g.terminate()}const{TABS:o,TOOLS:a}=t;const s={source:e,onSave:function(e,t){let i=document.createElement("a");i.href=e.imageBase64;i.download=e.fullName;i.click();console.log("Saved",e,t)},onBeforeSave:function(e){},annotationsCommon:{fill:"#00000000",stroke:"#ff0000",strokeWidth:2},Text:{text:"Text..."},Rotate:{angle:90,componentType:"slider"},translations:{profile:"Profile",coverPhoto:"Cover photo",facebook:"Facebook",socialMedia:"Social Media",fbProfileSize:"180x180px",fbCoverPhotoSize:"820x312px"},Crop:{presetsItems:[{titleKey:"classicTv",descriptionKey:"4:3",ratio:4/3},{titleKey:"cinemascope",descriptionKey:"21:9",ratio:21/9}],presetsFolders:[{titleKey:"socialMedia",groups:[{titleKey:"facebook",items:[{titleKey:"profile",width:180,height:180,descriptionKey:"fbProfileSize"},{titleKey:"coverPhoto",width:820,height:312,descriptionKey:"fbCoverPhotoSize"}]}]}]},tabsIds:[o.ADJUST,o.ANNOTATE],defaultTabId:o.ANNOTATE,defaultToolId:a.ELLIPSE,defaultSavedImageName:"image",defaultSavedImageType:"jpg"};let n=this.getView().byId("imgContainer");let l=n.getDomRef();this.getView().byId("imgContainer").destroyContent();g=new t(l,s);g.render({onClose:e=>{g.terminate()},onModify:function(e){let t=document.getElementById(i);let o=g.getCurrentImgData();let a=o.imageData.imageBase64;d[i]=a;this.getView().getModel("imgEditors").setData(d)}.bind(this)});m=i},_setNumberOfImagesInCarousel:function(e){if(!e||e<1||e>9){return}let t=this.getView().byId("carouselSample");t.destroyPages();t.setShowPageIndicator(false)},_addImageToCarousel:function(e){let t="img"+r;d[t]=e;this.getView().getModel("imgEditors").setData(d);let i=this.getView().byId("carouselSample");let o=new sap.m.Image(t,{src:`{imgEditors>/${t}}`,height:"8rem"});o.attachPress(this.onEditImage.bind(this));i.addPage(o);r++},onEditImage(e){let t=e.getParameter("id");if(m===t){return}let i=e.getSource();let o=i.mProperties.src;this.onOpenImgEditor(o,t)},onSaveAll:function(e){l("All Images Saved")}})});
//# sourceMappingURL=App.controller.js.map